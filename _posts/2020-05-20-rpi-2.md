---
layout: post
title: 라즈베리파이 웹 호스팅 서비스
published: true
---

## 서버 설정 (관리자)

 - ### 호스트이름 변경
서버를 설정하기에 앞서 호스트이름을 변경하겠습니다. ssh 로 로그인 된 상태에서 `sudo su -` 를 입력해서 사용자를 루트로 변경합니다.

![raspiconfig](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

그 다음 raspi-config를 입력해서 라즈베리파이 설정으로 들어갑니다.

![network](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

화살표키를 이용해 *2 Network Options*로 들어갑니다.

![hostname](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

*N1 Hostname*로 들어갑니다.

![enter](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

새 호스트이름을 입력하고 아래 *Ok*를 선택합니다.

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

그러면 메인메뉴로 돌아오게 되는데, *Finish*를 선택합니다.

![reboot](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

재부팅 할 것이냐고 묻는 메시지인데, *Yes*를 선택해서 재부팅합니다.

- ### 사용자 세팅
사용자가 호스팅 서비스를 사용할 수 있도록 세팅할 차례입니다.<br />
사용자에게 다음과 같은 요구사항이 있습니다:
- 도메인: 21900353.com
- 계정 이름: byun
- 계정 비밀번호 설정
- 계정에 접속해서 웹페이지 제작 가능
- git 설치

계정 생성을 하겠습니다. 사용자가 루트가 아니라면 `sudo su -`를 입력해서 변경합니다.

![useradd](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

`useradd -m byun`을 입력해서 *byun*이라는 계정을 만들었습니다. (저 메시지는 두 번 입력했기 때문에 이미 존재하는 계정을 중복해서 만들 수 없다는 뜻입니다) `passwd byun`을 입력하면 비밀번호를 설정하는 입력란이 나옵니다. 완료되면 "password updated successfully" 라는 메시지가 나옵니다.

다음으로 도메인 관련 설정을 할 것입니다. 

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

도메인 설정 파일이 */etc/nginx/sites-available* 디렉터리에 있어야 합니다. 저는 이 디렉터리로 이동한 후 작업했습니다. 이 디렉터리에서 *21900353.com*이라는 이름의 파일을 만들고 내용을 다음과 같이 합니다: 

    server {
    	listen 80;
    	listen [::]:80;

		server_name 21900353.com;

		root /home/byun/html;
		index index.html;
    }
내용은 서버 이름이 *21900353.com*이고, 사용자가 게재할 웹페이지 파일의 루트 디렉터리가 */home/byun/html*이고, 인덱스파일의 이름은 *index.html*이라는 것입니다.

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

그리고 이 파일이 */etc/nginx/sites-enabled/* 디렉터리에도 있어야 합니다. 실제로 활성화 할 사이트를 여기에 넣어야 합니다. 그러나 관리적인 측면에서 같은 내용의 사본이 있는 것 보다 심볼릭 링크를 두는 게 더 편할 것입니다. 그래서 `ln -s 21900353.com ../sites-enabled/21900353.com`을 입력해서 심볼릭 링크를 만들었습니다. 

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

여기까지 관리자 측 설정은 완료되었고, `nginx -t`를 입력해 nginx가 잘 실행될지 테스트 합니다. 위 사진에서 아무 이상이 없는 것을 확인할 수 있습니다. 

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

`service nginx restart`를 입력해서 nginx 서비스를 재시작합니다. 이제 관리자가 할 작업은 끝났습니다.

## 사용자 홈페이지 게재 (일반 사용자)
관리자가 설정이 완료되었다고 사용자에게 알리면, 사용자는 환경을 구축하기 시작하면 됩니다. 

### hosts 파일
웹페이지가 잘 나오는지 확인하기 위해 도메인이 필요한데, 이걸 위해 실제 도메인을 돈 주고 사는 편보다는 마치 진짜 도메인처럼 브라우저에 도메인주소를 입력할 수 있도록 만드는 편이 좋을 것 같습니다. 그러기 위해서 사용자 PC의 *hosts* 파일을 변경해야 합니다. 

![finish](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

윈도우의 *hosts* 파일은 *(윈도우 설치 드라이브)\Windows\System32\drivers\etc*에 있습니다. 그림과 같이 파일의 끝에 `IP주소 도메인` 을 추가하면 됩니다. 

### 홈페이지 게재
ssh로 새로 등록된 계정으로 로그인합니다. 

![passwd](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

로그인이 잘 됐습니다. 비밀번호를 변경할 수 있는지 확인차 `passwd byun`을 입력해봤습니다. 

![cat](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

홈 디렉터리에 *html* 디렉터리를 만들고 게재되는지 테스트하기 위해 그 안에 *index.html*을 만듭니다. 간단한 문구만 있어도 충분합니다. 

![cat](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

PC에서 21900353.com로 접속하면 방금 만든 인덱스 페이지가 잘 보이는 것을 확인했습니다. 제대로 된 홈페이지를 만들더라도 잘 게재될 것입니다. 

![git clone](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9)

제가 웹페이지를 만든 방법은 GitHub에서 공개된 웹페이지 템플릿을 검색해서 내용만 조금 수정했습니다. 제가 사용한 템플릿은 Start Bootstrap 프로젝트의 Freelancer라는 템플릿입니다. GitHub 저장소를 제 계정으로 fork 하고, 그 포크한 저장소를 사진에 나와있듯이 clone 했습니다. 포크된 저장소 주소는 [https://github.com/21900353/startbootstrap-freelancer](https://github.com/21900353/startbootstrap-freelancer)입니다. 

![cp](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9) 

템플릿의 구조는 */dist* 디렉터리에 *index.html*과 그 외 필요한 파일들이 들어있습니다. index.html 에 필요한 수정을 마친 후, /dist에 있는 모든 파일을 *html* 디렉터리로 복사했습니다. 사진에서는 git 관련 파일이 복사되지 않았다는데, git 파일은 웹페이지 게재에 중요하지 않으니 넘어갔습니다.  

![push](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9) 

`git add, commit, push` 해서 로컬 저장소와 원격 저장소를 업데이트 했습니다. 

![21900353.com](%E3%84%B4%E3%85%87%E3%85%81%E3%84%B9) 

로컬 PC에서 21900353.com 페이지에 다시 접속하니 바뀐 웹페이지가 나옵니다. 웹페이지 게재가 잘 이루어졌습니다.
